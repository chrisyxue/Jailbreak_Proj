>>> Initializing Models
Save Dir: /scratch/zx1673/codes/jailbreak_proj/Visual-Adversarial-Examples-Jailbreak-Large-Language-Models/results_text_attack/attack_5000_50_8
Loading VIT
Loading VIT Done
Loading Q-Former
Loading Q-Former Done
Loading LLAMA
/scratch/zx1673/codes/jailbreak_proj/model/vicuna

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:20<00:41, 20.65s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:35<00:17, 17.37s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:45<00:00, 13.84s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:45<00:00, 15.12s/it]
Loading LLAMA Done
Load BLIP2-LLM Checkpoint: /scratch/zx1673/codes/jailbreak_proj/model/mini-gpt4/pretrained_minigpt4.pth
[Initialization Finished]

Save Dir /scratch/zx1673/codes/jailbreak_proj/Visual-Adversarial-Examples-Jailbreak-Large-Language-Models/results_text_attack/attack_5000_50_8
>>> batch_size:  8
  0%|          | 0/5001 [00:00<?, ?it/s]/home/zx1673/.local/lib/python3.9/site-packages/transformers/generation/utils.py:1219: UserWarning: You have modified the pretrained model configuration to control generation. This is a deprecated strategy to control generation and will be removed soon, in a future version. Please use a generation configuration file (see https://huggingface.co/docs/transformers/main_classes/text_generation)
  warnings.warn(
  0%|          | 1/5001 [13:05<1091:14:15, 785.69s/it]  0%|          | 2/5001 [27:04<1134:14:06, 816.81s/it]  0%|          | 3/5001 [40:53<1142:07:49, 822.66s/it]  0%|          | 4/5001 [54:45<1146:54:42, 826.27s/it]  0%|          | 5/5001 [1:08:23<1142:23:44, 823.18s/it]  0%|          | 6/5001 [1:22:34<1155:17:22, 832.64s/it]  0%|          | 7/5001 [1:36:48<1164:53:50, 839.73s/it]  0%|          | 8/5001 [1:50:14<1149:30:50, 828.81s/it]  0%|          | 9/5001 [2:03:26<1133:25:03, 817.37s/it]  0%|          | 10/5001 [2:16:55<1129:26:25, 814.66s/it]  0%|          | 11/5001 [2:30:39<1133:26:10, 817.71s/it]  0%|          | 12/5001 [2:44:29<1138:30:46, 821.54s/it]  0%|          | 13/5001 [2:58:25<1143:59:01, 825.65s/it]  0%|          | 14/5001 [3:12:28<1151:04:40, 830.94s/it]  0%|          | 15/5001 [3:25:37<1133:33:44, 818.46s/it]  0%|          | 16/5001 [3:39:38<1142:29:59, 825.08s/it]  0%|          | 17/5001 [3:52:52<1129:37:55, 815.95s/it]  0%|          | 18/5001 [4:06:27<1128:50:38, 815.54s/it]  0%|          | 19/5001 [4:20:02<1128:27:25, 815.42s/it]  0%|          | 20/5001 [4:33:25<1123:13:01, 811.80s/it]  0%|          | 21/5001 [4:47:22<1133:11:51, 819.18s/it]  0%|          | 22/5001 [5:00:54<1130:06:50, 817.11s/it]  0%|          | 23/5001 [5:14:12<1121:48:20, 811.27s/it]  0%|          | 24/5001 [5:27:58<1127:39:41, 815.67s/it]  0%|          | 25/5001 [5:41:15<1119:40:17, 810.05s/it]  1%|          | 26/5001 [5:55:32<1138:51:35, 824.10s/it]  1%|          | 27/5001 [6:09:26<1142:45:05, 827.08s/it]  1%|          | 28/5001 [6:23:46<1156:21:45, 837.10s/it]  1%|          | 29/5001 [6:36:57<1136:55:30, 823.20s/it]  1%|          | 30/5001 [6:50:15<1126:25:12, 815.75s/it]  1%|          | 31/5001 [7:04:15<1136:18:17, 823.08s/it]  1%|          | 32/5001 [7:18:16<1143:20:40, 828.34s/it]  1%|          | 33/5001 [7:32:18<1148:50:36, 832.50s/it]  1%|          | 34/5001 [7:46:28<1155:39:53, 837.61s/it]  1%|          | 35/5001 [7:59:59<1144:44:00, 829.85s/it]  1%|          | 36/5001 [8:13:54<1146:24:08, 831.23s/it]  1%|          | 37/5001 [8:27:56<1150:44:46, 834.55s/it]  1%|          | 38/5001 [8:41:14<1135:11:00, 823.43s/it]  1%|          | 39/5001 [8:54:40<1127:43:22, 818.18s/it]  1%|          | 40/5001 [9:07:40<1111:55:58, 806.89s/it]  1%|          | 41/5001 [9:20:58<1107:51:42, 804.09s/it]  1%|          | 42/5001 [9:33:58<1097:36:33, 796.81s/it]  1%|          | 43/5001 [9:47:43<1109:08:07, 805.34s/it]  1%|          | 44/5001 [10:00:45<1099:24:10, 798.44s/it]  1%|          | 45/5001 [10:14:10<1101:40:57, 800.25s/it]  1%|          | 46/5001 [10:27:20<1097:27:59, 797.35s/it]  1%|          | 47/5001 [10:41:08<1109:55:39, 806.57s/it]  1%|          | 48/5001 [10:55:01<1120:38:37, 814.52s/it]  1%|          | 49/5001 [11:08:15<1112:00:12, 808.40s/it]  1%|          | 50/5001 [11:21:25<1104:06:16, 802.82s/it]  1%|          | 51/5001 [11:35:13<1114:02:26, 810.21s/it]  1%|          | 52/5001 [11:48:26<1106:57:26, 805.22s/it]  1%|          | 53/5001 [12:01:42<1102:39:32, 802.26s/it]  1%|          | 54/5001 [12:14:58<1099:57:19, 800.45s/it]  1%|          | 55/5001 [12:28:52<1113:35:42, 810.54s/it]  1%|          | 56/5001 [12:42:17<1110:55:49, 808.77s/it]  1%|          | 57/5001 [12:55:26<1102:51:08, 803.05s/it]  1%|          | 58/5001 [13:08:39<1098:10:27, 799.80s/it]  1%|          | 59/5001 [13:21:54<1096:03:56, 798.43s/it]  1%|          | 60/5001 [13:35:33<1104:13:19, 804.53s/it]  1%|          | 61/5001 [13:48:49<1100:34:46, 802.04s/it]  1%|          | 62/5001 [14:02:19<1103:41:53, 804.48s/it]  1%|▏         | 63/5001 [14:15:35<1100:10:04, 802.07s/it]  1%|▏         | 64/5001 [14:29:09<1104:45:03, 805.57s/it]  1%|▏         | 65/5001 [14:42:49<1110:29:42, 809.92s/it]  1%|▏         | 66/5001 [14:56:08<1105:51:42, 806.71s/it]  1%|▏         | 67/5001 [15:09:23<1100:47:27, 803.17s/it]  1%|▏         | 68/5001 [15:22:53<1103:07:33, 805.04s/it]  1%|▏         | 69/5001 [15:35:54<1093:01:38, 797.83s/it]  1%|▏         | 70/5001 [15:48:58<1087:02:04, 793.62s/it]  1%|▏         | 71/5001 [16:02:17<1089:19:45, 795.45s/it]  1%|▏         | 72/5001 [16:15:49<1095:42:06, 800.27s/it]  1%|▏         | 73/5001 [16:29:52<1113:02:45, 813.10s/it]  1%|▏         | 74/5001 [16:43:16<1109:08:06, 810.41s/it]  1%|▏         | 75/5001 [16:56:42<1107:13:19, 809.18s/it]  2%|▏         | 76/5001 [17:09:48<1097:24:09, 802.16s/it]  2%|▏         | 77/5001 [17:22:50<1089:04:08, 796.23s/it]  2%|▏         | 78/5001 [17:35:44<1079:28:27, 789.38s/it]  2%|▏         | 79/5001 [17:48:57<1080:38:50, 790.40s/it]  2%|▏         | 80/5001 [18:02:39<1093:26:01, 799.91s/it]  2%|▏         | 81/5001 [18:16:41<1110:23:50, 812.49s/it]  2%|▏         | 82/5001 [18:29:56<1103:05:22, 807.30s/it]  2%|▏         | 83/5001 [18:43:08<1096:54:33, 802.94s/it]  2%|▏         | 84/5001 [18:56:59<1108:00:43, 811.24s/it]  2%|▏         | 85/5001 [19:10:01<1095:38:26, 802.34s/it]  2%|▏         | 86/5001 [19:23:24<1095:38:49, 802.51s/it]  2%|▏         | 87/5001 [19:36:38<1092:04:55, 800.06s/it]  2%|▏         | 88/5001 [19:50:17<1099:45:42, 805.85s/it]  2%|▏         | 89/5001 [20:04:14<1112:02:34, 815.02s/it]  2%|▏         | 90/5001 [20:18:14<1122:20:06, 822.73s/it]  2%|▏         | 91/5001 [20:32:12<1128:23:41, 827.34s/it]  2%|▏         | 92/5001 [20:45:56<1126:47:16, 826.33s/it]  2%|▏         | 93/5001 [20:59:53<1130:32:24, 829.25s/it]  2%|▏         | 94/5001 [21:12:56<1111:36:30, 815.53s/it]  2%|▏         | 95/5001 [21:27:00<1123:03:33, 824.10s/it]  2%|▏         | 96/5001 [21:40:32<1117:56:33, 820.51s/it]  2%|▏         | 97/5001 [21:53:43<1105:25:39, 811.49s/it]  2%|▏         | 98/5001 [22:07:06<1101:47:56, 808.99s/it]  2%|▏         | 99/5001 [22:20:23<1096:51:38, 805.53s/it]  2%|▏         | 100/5001 [22:33:58<1100:28:41, 808.35s/it]  2%|▏         | 101/5001 [22:48:07<1116:43:27, 820.45s/it]  2%|▏         | 102/5001 [23:01:38<1112:28:46, 817.50s/it]  2%|▏         | 103/5001 [23:15:40<1122:20:16, 824.91s/it]  2%|▏         | 104/5001 [23:29:07<1115:03:04, 819.72s/it]  2%|▏         | 105/5001 [23:42:54<1117:40:20, 821.82s/it]  2%|▏         | 106/5001 [23:56:35<1117:06:58, 821.58s/it]  2%|▏         | 107/5001 [24:09:30<1098:03:43, 807.73s/it]  2%|▏         | 108/5001 [24:23:19<1106:06:45, 813.82s/it]  2%|▏         | 109/5001 [24:37:09<1112:52:05, 818.95s/it]  2%|▏         | 110/5001 [24:50:08<1096:03:42, 806.75s/it]  2%|▏         | 111/5001 [25:03:14<1087:40:44, 800.75s/it]  2%|▏         | 112/5001 [25:17:03<1098:41:46, 809.02s/it]  2%|▏         | 113/5001 [25:30:21<1094:05:27, 805.80s/it]  2%|▏         | 114/5001 [25:44:03<1100:36:57, 810.77s/it]  2%|▏         | 115/5001 [25:57:59<1110:38:29, 818.32s/it]  2%|▏         | 116/5001 [26:11:19<1102:59:37, 812.85s/it]  2%|▏         | 117/5001 [26:25:14<1111:32:30, 819.32s/it]  2%|▏         | 118/5001 [26:38:35<1103:46:37, 813.76s/it]  2%|▏         | 119/5001 [26:52:02<1101:04:17, 811.93s/it]  2%|▏         | 120/5001 [27:05:14<1092:48:03, 806.00s/it]  2%|▏         | 121/5001 [27:18:31<1088:38:49, 803.10s/it]  2%|▏         | 122/5001 [27:32:26<1101:25:44, 812.70s/it]  2%|▏         | 123/5001 [27:45:56<1100:18:03, 812.03s/it]  2%|▏         | 124/5001 [27:59:08<1091:38:39, 805.81s/it]  2%|▏         | 125/5001 [28:13:00<1102:15:38, 813.81s/it]  3%|▎         | 126/5001 [28:26:03<1089:23:51, 804.48s/it]  3%|▎         | 127/5001 [28:39:25<1088:06:40, 803.69s/it]  3%|▎         | 128/5001 [28:52:30<1080:19:01, 798.10s/it]  3%|▎         | 129/5001 [29:05:35<1074:53:51, 794.26s/it]  3%|▎         | 130/5001 [29:18:34<1068:31:23, 789.71s/it]  3%|▎         | 131/5001 [29:32:14<1080:32:36, 798.76s/it]  3%|▎         | 132/5001 [29:45:14<1072:41:58, 793.12s/it]  3%|▎         | 133/5001 [29:58:23<1070:54:10, 791.96s/it]  3%|▎         | 134/5001 [30:11:46<1074:53:50, 795.08s/it]  3%|▎         | 135/5001 [30:24:49<1069:54:35, 791.55s/it]  3%|▎         | 136/5001 [30:38:07<1072:29:05, 793.62s/it]  3%|▎         | 137/5001 [30:51:31<1076:17:09, 796.59s/it]  3%|▎         | 138/5001 [31:04:40<1073:07:38, 794.42s/it]  3%|▎         | 139/5001 [31:18:22<1084:08:04, 802.73s/it]  3%|▎         | 140/5001 [31:31:40<1081:47:50, 801.17s/it]  3%|▎         | 141/5001 [31:45:03<1082:24:19, 801.78s/it]  3%|▎         | 142/5001 [31:58:40<1088:26:01, 806.41s/it]  3%|▎         | 143/5001 [32:12:23<1094:58:25, 811.43s/it]  3%|▎         | 144/5001 [32:25:36<1087:07:31, 805.78s/it]  3%|▎         | 145/5001 [32:38:51<1082:33:25, 802.55s/it]  3%|▎         | 146/5001 [32:52:20<1084:57:22, 804.50s/it]  3%|▎         | 147/5001 [33:06:11<1095:32:51, 812.52s/it]  3%|▎         | 148/5001 [33:19:56<1100:03:40, 816.04s/it]  3%|▎         | 149/5001 [33:33:45<1105:10:15, 820.00s/it]  3%|▎         | 150/5001 [33:47:23<1104:11:13, 819.43s/it]  3%|▎         | 151/5001 [34:01:26<1113:40:02, 826.64s/it]  3%|▎         | 152/5001 [34:15:10<1112:23:55, 825.87s/it]  3%|▎         | 153/5001 [34:28:35<1103:30:50, 819.44s/it]  3%|▎         | 154/5001 [34:42:15<1103:22:49, 819.51s/it]  3%|▎         | 155/5001 [34:55:18<1088:27:09, 808.59s/it]  3%|▎         | 156/5001 [35:08:45<1087:49:33, 808.29s/it]  3%|▎         | 157/5001 [35:21:55<1080:11:05, 802.78s/it]  3%|▎         | 158/5001 [35:35:14<1078:16:59, 801.53s/it]  3%|▎         | 159/5001 [35:49:02<1088:56:32, 809.62s/it]  3%|▎         | 160/5001 [36:02:14<1081:34:57, 804.32s/it]  3%|▎         | 161/5001 [36:15:20<1074:01:01, 798.86s/it]  3%|▎         | 162/5001 [36:28:32<1070:59:54, 796.77s/it]  3%|▎         | 163/5001 [36:42:21<1083:37:40, 806.34s/it]  3%|▎         | 164/5001 [36:56:09<1092:00:40, 812.74s/it]  3%|▎         | 165/5001 [37:09:24<1084:56:27, 807.65s/it]  3%|▎         | 166/5001 [37:22:36<1078:13:58, 802.82s/it]  3%|▎         | 167/5001 [37:36:23<1087:39:29, 810.01s/it]  3%|▎         | 168/5001 [37:50:09<1094:04:28, 814.95s/it]  3%|▎         | 169/5001 [38:04:00<1100:07:55, 819.63s/it]  3%|▎         | 170/5001 [38:17:06<1086:24:35, 809.58s/it]  3%|▎         | 171/5001 [38:30:12<1076:31:54, 802.38s/it]  3%|▎         | 172/5001 [38:43:20<1070:40:45, 798.19s/it]  3%|▎         | 173/5001 [38:56:14<1060:48:51, 791.00s/it]  3%|▎         | 174/5001 [39:09:21<1058:58:27, 789.79s/it]  3%|▎         | 175/5001 [39:22:27<1057:23:27, 788.77s/it]  4%|▎         | 176/5001 [39:35:41<1059:12:13, 790.29s/it]  4%|▎         | 177/5001 [39:48:44<1055:56:29, 788.02s/it]  4%|▎         | 178/5001 [40:02:37<1073:52:48, 801.57s/it]  4%|▎         | 179/5001 [40:15:44<1067:34:13, 797.02s/it]  4%|▎         | 180/5001 [40:28:56<1065:24:39, 795.58s/it]  4%|▎         | 181/5001 [40:42:03<1061:56:51, 793.16s/it]  4%|▎         | 182/5001 [40:54:59<1054:36:02, 787.83s/it]  4%|▎         | 183/5001 [41:08:41<1068:05:42, 798.08s/it]  4%|▎         | 184/5001 [41:22:02<1069:20:25, 799.17s/it]  4%|▎         | 185/5001 [41:35:59<1084:04:44, 810.36s/it]  4%|▎         | 186/5001 [41:49:05<1073:56:40, 802.95s/it]  4%|▎         | 187/5001 [42:02:15<1068:42:17, 799.20s/it]  4%|▍         | 188/5001 [42:16:10<1082:47:52, 809.90s/it]  4%|▍         | 189/5001 [42:30:08<1093:59:50, 818.45s/it]  4%|▍         | 190/5001 [42:43:29<1086:40:29, 813.14s/it]  4%|▍         | 191/5001 [42:56:50<1081:34:51, 809.50s/it]  4%|▍         | 192/5001 [43:10:17<1080:09:43, 808.61s/it]  4%|▍         | 193/5001 [43:24:21<1094:19:16, 819.38s/it]  4%|▍         | 194/5001 [43:37:27<1080:42:22, 809.35s/it]  4%|▍         | 195/5001 [43:50:50<1077:43:33, 807.29s/it]  4%|▍         | 196/5001 [44:04:46<1089:21:38, 816.17s/it]  4%|▍         | 197/5001 [44:17:40<1072:10:51, 803.47s/it]  4%|▍         | 198/5001 [44:30:53<1067:43:33, 800.29s/it]  4%|▍         | 199/5001 [44:43:56<1060:38:33, 795.15s/it]  4%|▍         | 200/5001 [44:56:57<1054:36:14, 790.79s/it]  4%|▍         | 201/5001 [45:10:51<1071:46:07, 803.83s/it]  4%|▍         | 202/5001 [45:24:27<1076:26:48, 807.50s/it]  4%|▍         | 203/5001 [45:37:29<1066:07:50, 799.93s/it]  4%|▍         | 204/5001 [45:50:53<1067:08:55, 800.86s/it]  4%|▍         | 205/5001 [46:04:14<1067:16:42, 801.13s/it]  4%|▍         | 206/5001 [46:17:31<1065:28:12, 799.94s/it]  4%|▍         | 207/5001 [46:31:33<1081:59:11, 812.51s/it]  4%|▍         | 208/5001 [46:44:45<1073:32:37, 806.33s/it]  4%|▍         | 209/5001 [46:57:55<1066:47:39, 801.43s/it]  4%|▍         | 210/5001 [47:11:07<1062:41:23, 798.51s/it]  4%|▍         | 211/5001 [47:25:04<1078:01:31, 810.21s/it]  4%|▍         | 212/5001 [47:38:25<1073:48:50, 807.21s/it]  4%|▍         | 213/5001 [47:52:27<1087:28:46, 817.65s/it]slurmstepd: error: *** JOB 45459638 ON gr051 CANCELLED AT 2024-04-23T19:55:42 DUE TO TIME LIMIT ***
