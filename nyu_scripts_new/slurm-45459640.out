>>> Initializing Models
Save Dir: /scratch/zx1673/codes/jailbreak_proj/Visual-Adversarial-Examples-Jailbreak-Large-Language-Models/results_text_attack/attack_selection_10_Detoxify_Rank_Discreate/attack_5000_50_8
Loading VIT
Loading VIT Done
Loading Q-Former
Loading Q-Former Done
Loading LLAMA
/scratch/zx1673/codes/jailbreak_proj/model/vicuna

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:20<00:40, 20.46s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:34<00:16, 16.92s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:44<00:00, 13.54s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:44<00:00, 14.81s/it]
Loading LLAMA Done
Load BLIP2-LLM Checkpoint: /scratch/zx1673/codes/jailbreak_proj/model/mini-gpt4/pretrained_minigpt4.pth
[Initialization Finished]

Save Dir /scratch/zx1673/codes/jailbreak_proj/Visual-Adversarial-Examples-Jailbreak-Large-Language-Models/results_text_attack/attack_selection_10_Detoxify_Rank_Discreate/attack_5000_50_8
>>> batch_size:  8
  0%|          | 0/5001 [00:00<?, ?it/s]/home/zx1673/.local/lib/python3.9/site-packages/transformers/generation/utils.py:1219: UserWarning: You have modified the pretrained model configuration to control generation. This is a deprecated strategy to control generation and will be removed soon, in a future version. Please use a generation configuration file (see https://huggingface.co/docs/transformers/main_classes/text_generation)
  warnings.warn(
  0%|          | 1/5001 [13:26<1120:17:08, 806.61s/it]  0%|          | 2/5001 [26:35<1105:35:50, 796.19s/it]  0%|          | 3/5001 [39:48<1103:14:19, 794.65s/it]  0%|          | 4/5001 [53:03<1103:18:31, 794.86s/it]  0%|          | 5/5001 [1:06:20<1104:11:52, 795.66s/it]  0%|          | 6/5001 [1:19:44<1107:42:13, 798.35s/it]  0%|          | 7/5001 [1:33:07<1109:41:03, 799.93s/it]  0%|          | 8/5001 [1:46:59<1123:35:30, 810.12s/it]  0%|          | 9/5001 [2:00:24<1121:13:39, 808.58s/it]  0%|          | 10/5001 [2:14:15<1130:43:55, 815.60s/it]  0%|          | 11/5001 [2:28:08<1137:54:39, 820.94s/it]  0%|          | 12/5001 [2:41:19<1124:48:10, 811.64s/it]  0%|          | 13/5001 [2:54:49<1123:59:50, 811.22s/it]  0%|          | 14/5001 [3:08:20<1123:53:21, 811.31s/it]  0%|          | 15/5001 [3:22:15<1133:10:23, 818.18s/it]  0%|          | 16/5001 [3:36:27<1147:25:06, 828.63s/it]  0%|          | 17/5001 [3:50:13<1145:47:03, 827.61s/it]  0%|          | 18/5001 [4:04:33<1158:58:47, 837.31s/it]  0%|          | 19/5001 [4:18:52<1167:52:52, 843.91s/it]  0%|          | 20/5001 [4:32:43<1162:21:38, 840.09s/it]  0%|          | 21/5001 [4:46:26<1154:59:14, 834.93s/it]  0%|          | 22/5001 [5:00:12<1151:14:04, 832.38s/it]  0%|          | 23/5001 [5:13:58<1148:10:30, 830.34s/it]  0%|          | 24/5001 [5:27:43<1145:36:35, 828.65s/it]  0%|          | 25/5001 [5:41:40<1148:57:10, 831.24s/it]  1%|          | 26/5001 [5:56:36<1175:29:52, 850.61s/it]  1%|          | 27/5001 [6:10:49<1176:25:51, 851.46s/it]  1%|          | 28/5001 [6:24:39<1167:21:04, 845.06s/it]  1%|          | 29/5001 [6:38:15<1154:47:34, 836.13s/it]  1%|          | 30/5001 [6:51:51<1146:27:07, 830.26s/it]  1%|          | 31/5001 [7:05:31<1142:05:14, 827.27s/it]  1%|          | 32/5001 [7:19:20<1142:21:27, 827.63s/it]  1%|          | 33/5001 [7:32:55<1136:46:25, 823.75s/it]  1%|          | 34/5001 [7:47:19<1153:20:42, 835.93s/it]  1%|          | 35/5001 [8:01:17<1154:02:12, 836.60s/it]  1%|          | 36/5001 [8:15:21<1156:44:18, 838.72s/it]  1%|          | 37/5001 [8:30:17<1180:24:05, 856.05s/it]  1%|          | 38/5001 [8:44:50<1186:56:48, 860.97s/it]  1%|          | 39/5001 [8:59:00<1182:11:48, 857.70s/it]  1%|          | 40/5001 [9:12:41<1166:48:53, 846.71s/it]  1%|          | 41/5001 [9:26:13<1152:06:22, 836.21s/it]  1%|          | 42/5001 [9:40:29<1160:15:32, 842.29s/it]  1%|          | 43/5001 [9:54:41<1164:02:56, 845.22s/it]  1%|          | 44/5001 [10:08:21<1153:29:54, 837.72s/it]  1%|          | 45/5001 [10:21:53<1142:17:43, 829.75s/it]  1%|          | 46/5001 [10:36:04<1150:55:38, 836.19s/it]  1%|          | 47/5001 [10:49:37<1141:13:18, 829.31s/it]  1%|          | 48/5001 [11:03:22<1139:14:52, 828.04s/it]  1%|          | 49/5001 [11:16:55<1132:54:15, 823.60s/it]  1%|          | 50/5001 [11:30:28<1128:02:54, 820.23s/it]  1%|          | 51/5001 [11:44:08<1128:00:42, 820.37s/it]  1%|          | 52/5001 [11:58:19<1140:06:54, 829.34s/it]  1%|          | 53/5001 [12:11:38<1127:29:33, 820.33s/it]  1%|          | 54/5001 [12:25:48<1139:37:35, 829.32s/it]  1%|          | 55/5001 [12:39:59<1148:03:40, 835.63s/it]  1%|          | 56/5001 [12:53:37<1140:54:21, 830.59s/it]  1%|          | 57/5001 [13:07:13<1134:18:13, 825.95s/it]  1%|          | 58/5001 [13:21:25<1144:53:10, 833.82s/it]  1%|          | 59/5001 [13:35:23<1146:37:54, 835.26s/it]  1%|          | 60/5001 [13:48:54<1136:14:15, 827.86s/it]  1%|          | 61/5001 [14:03:05<1145:32:18, 834.81s/it]  1%|          | 62/5001 [14:16:41<1137:33:25, 829.16s/it]  1%|▏         | 63/5001 [14:30:48<1144:40:51, 834.52s/it]  1%|▏         | 64/5001 [14:45:00<1151:48:12, 839.88s/it]  1%|▏         | 65/5001 [14:59:00<1151:27:09, 839.80s/it]  1%|▏         | 66/5001 [15:13:07<1154:04:07, 841.87s/it]  1%|▏         | 67/5001 [15:26:59<1150:00:11, 839.08s/it]  1%|▏         | 68/5001 [15:40:27<1137:01:50, 829.78s/it]  1%|▏         | 69/5001 [15:54:30<1142:03:19, 833.62s/it]  1%|▏         | 70/5001 [16:07:52<1128:57:44, 824.23s/it]  1%|▏         | 71/5001 [16:21:11<1118:04:59, 816.45s/it]  1%|▏         | 72/5001 [16:34:46<1117:15:09, 816.01s/it]  1%|▏         | 73/5001 [16:49:01<1133:25:19, 827.99s/it]  1%|▏         | 74/5001 [17:02:31<1125:35:17, 822.43s/it]  1%|▏         | 75/5001 [17:16:42<1137:04:26, 830.99s/it]  2%|▏         | 76/5001 [17:30:28<1134:54:47, 829.58s/it]  2%|▏         | 77/5001 [17:43:53<1124:36:16, 822.21s/it]  2%|▏         | 78/5001 [17:57:21<1118:16:24, 817.75s/it]  2%|▏         | 79/5001 [18:11:28<1130:12:47, 826.65s/it]  2%|▏         | 80/5001 [18:25:13<1129:28:36, 826.28s/it]  2%|▏         | 81/5001 [18:38:40<1121:13:51, 820.41s/it]  2%|▏         | 82/5001 [18:52:51<1133:28:28, 829.54s/it]  2%|▏         | 83/5001 [19:07:03<1142:32:43, 836.35s/it]  2%|▏         | 84/5001 [19:20:39<1134:01:03, 830.28s/it]  2%|▏         | 85/5001 [19:34:21<1130:12:40, 827.66s/it]  2%|▏         | 86/5001 [19:47:46<1120:54:14, 821.01s/it]  2%|▏         | 87/5001 [20:01:51<1130:23:49, 828.13s/it]  2%|▏         | 88/5001 [20:16:08<1142:00:57, 836.81s/it]  2%|▏         | 89/5001 [20:30:28<1151:01:33, 843.59s/it]  2%|▏         | 90/5001 [20:44:14<1143:40:28, 838.37s/it]  2%|▏         | 91/5001 [20:58:34<1152:30:53, 845.02s/it]  2%|▏         | 92/5001 [21:12:25<1146:23:09, 840.70s/it]  2%|▏         | 93/5001 [21:26:20<1143:52:49, 839.03s/it]  2%|▏         | 94/5001 [21:40:28<1147:22:59, 841.77s/it]  2%|▏         | 95/5001 [21:54:10<1138:56:19, 835.75s/it]  2%|▏         | 96/5001 [22:08:30<1148:43:48, 843.10s/it]  2%|▏         | 97/5001 [22:22:35<1149:08:55, 843.58s/it]  2%|▏         | 98/5001 [22:36:13<1138:32:19, 835.97s/it]  2%|▏         | 99/5001 [22:50:13<1139:59:29, 837.20s/it]  2%|▏         | 100/5001 [23:04:21<1143:56:52, 840.28s/it]  2%|▏         | 101/5001 [23:18:42<1152:18:19, 846.59s/it]  2%|▏         | 102/5001 [23:33:08<1160:14:11, 852.59s/it]  2%|▏         | 103/5001 [23:46:41<1143:29:27, 840.46s/it]  2%|▏         | 104/5001 [24:01:25<1161:04:50, 853.56s/it]  2%|▏         | 105/5001 [24:15:55<1167:39:47, 858.58s/it]  2%|▏         | 106/5001 [24:31:09<1190:01:16, 875.19s/it]  2%|▏         | 107/5001 [24:45:37<1186:39:40, 872.90s/it]  2%|▏         | 108/5001 [24:59:51<1178:41:47, 867.22s/it]  2%|▏         | 109/5001 [25:14:18<1178:24:37, 867.19s/it]  2%|▏         | 110/5001 [25:28:54<1181:53:49, 869.93s/it]  2%|▏         | 111/5001 [25:43:28<1183:18:28, 871.15s/it]  2%|▏         | 112/5001 [25:58:32<1196:38:22, 881.14s/it]  2%|▏         | 113/5001 [26:13:33<1204:28:47, 887.10s/it]  2%|▏         | 114/5001 [26:28:35<1210:06:59, 891.43s/it]  2%|▏         | 115/5001 [26:43:39<1215:07:16, 895.30s/it]  2%|▏         | 116/5001 [26:58:45<1219:09:07, 898.45s/it]  2%|▏         | 117/5001 [27:13:52<1222:23:28, 901.03s/it]  2%|▏         | 118/5001 [27:28:40<1216:35:27, 896.93s/it]  2%|▏         | 119/5001 [27:43:04<1203:05:20, 887.16s/it]  2%|▏         | 120/5001 [27:57:29<1193:49:03, 880.50s/it]  2%|▏         | 121/5001 [28:12:32<1202:39:38, 887.21s/it]  2%|▏         | 122/5001 [28:27:36<1209:16:33, 892.27s/it]  2%|▏         | 123/5001 [28:42:40<1213:48:24, 895.80s/it]  2%|▏         | 124/5001 [28:56:57<1197:51:34, 884.21s/it]  2%|▏         | 125/5001 [29:11:07<1183:42:08, 873.94s/it]  3%|▎         | 126/5001 [29:25:29<1178:47:05, 870.49s/it]  3%|▎         | 127/5001 [29:40:35<1192:58:49, 881.15s/it]  3%|▎         | 128/5001 [29:55:21<1194:21:53, 882.35s/it]  3%|▎         | 129/5001 [30:10:25<1203:11:51, 889.06s/it]  3%|▎         | 130/5001 [30:25:31<1209:41:06, 894.04s/it]  3%|▎         | 131/5001 [30:40:25<1209:38:13, 894.19s/it]  3%|▎         | 132/5001 [30:55:00<1201:35:19, 888.42s/it]  3%|▎         | 133/5001 [31:10:04<1207:39:09, 893.09s/it]  3%|▎         | 134/5001 [31:24:18<1191:21:36, 881.22s/it]  3%|▎         | 135/5001 [31:38:33<1180:34:37, 873.42s/it]  3%|▎         | 136/5001 [31:52:52<1174:20:47, 868.99s/it]  3%|▎         | 137/5001 [32:07:34<1179:23:58, 872.91s/it]  3%|▎         | 138/5001 [32:22:09<1180:12:41, 873.69s/it]  3%|▎         | 139/5001 [32:36:03<1163:51:04, 861.76s/it]  3%|▎         | 140/5001 [32:50:42<1170:24:53, 866.80s/it]  3%|▎         | 141/5001 [33:04:35<1156:33:28, 856.71s/it]  3%|▎         | 142/5001 [33:18:45<1153:33:11, 854.66s/it]  3%|▎         | 143/5001 [33:32:36<1143:46:25, 847.59s/it]  3%|▎         | 144/5001 [33:46:27<1136:45:36, 842.56s/it]  3%|▎         | 145/5001 [34:00:19<1132:27:22, 839.55s/it]  3%|▎         | 146/5001 [34:14:01<1124:56:02, 834.14s/it]  3%|▎         | 147/5001 [34:28:12<1131:25:58, 839.13s/it]  3%|▎         | 148/5001 [34:42:07<1129:37:29, 837.97s/it]  3%|▎         | 149/5001 [34:56:42<1144:17:25, 849.02s/it]  3%|▎         | 150/5001 [35:10:19<1131:19:41, 839.58s/it]  3%|▎         | 151/5001 [35:24:38<1138:59:01, 845.43s/it]  3%|▎         | 152/5001 [35:38:23<1130:17:29, 839.15s/it]  3%|▎         | 153/5001 [35:52:56<1143:49:03, 849.37s/it]  3%|▎         | 154/5001 [36:07:30<1153:32:43, 856.77s/it]  3%|▎         | 155/5001 [36:22:07<1161:20:33, 862.74s/it]  3%|▎         | 156/5001 [36:36:37<1164:09:13, 865.01s/it]  3%|▎         | 157/5001 [36:50:45<1156:51:57, 859.77s/it]  3%|▎         | 158/5001 [37:05:20<1162:50:37, 864.39s/it]  3%|▎         | 159/5001 [37:19:34<1158:36:44, 861.42s/it]  3%|▎         | 160/5001 [37:33:17<1142:56:03, 849.94s/it]  3%|▎         | 161/5001 [37:47:52<1152:34:09, 857.28s/it]  3%|▎         | 162/5001 [38:02:26<1159:09:32, 862.36s/it]  3%|▎         | 163/5001 [38:16:43<1156:55:11, 860.87s/it]  3%|▎         | 164/5001 [38:31:19<1162:35:22, 865.27s/it]  3%|▎         | 165/5001 [38:45:28<1155:40:10, 860.30s/it]  3%|▎         | 166/5001 [38:59:18<1143:28:47, 851.40s/it]  3%|▎         | 167/5001 [39:13:40<1147:14:56, 854.38s/it]  3%|▎         | 168/5001 [39:27:18<1132:36:00, 843.65s/it]  3%|▎         | 169/5001 [39:41:14<1129:11:53, 841.29s/it]  3%|▎         | 170/5001 [39:55:44<1140:26:17, 849.84s/it]  3%|▎         | 171/5001 [40:09:33<1131:45:15, 843.54s/it]  3%|▎         | 172/5001 [40:23:16<1123:27:35, 837.53s/it]  3%|▎         | 173/5001 [40:37:28<1128:52:26, 841.75s/it]  3%|▎         | 174/5001 [40:51:11<1121:01:37, 836.07s/it]  3%|▎         | 175/5001 [41:04:55<1116:15:01, 832.68s/it]  4%|▎         | 176/5001 [41:19:00<1120:50:54, 836.28s/it]  4%|▎         | 177/5001 [41:33:36<1136:43:42, 848.30s/it]  4%|▎         | 178/5001 [41:48:12<1147:27:55, 856.49s/it]  4%|▎         | 179/5001 [42:02:16<1142:13:57, 852.77s/it]  4%|▎         | 180/5001 [42:16:05<1132:35:51, 845.75s/it]  4%|▎         | 181/5001 [42:30:04<1129:17:00, 843.45s/it]  4%|▎         | 182/5001 [42:44:11<1130:38:49, 844.64s/it]  4%|▎         | 183/5001 [42:58:49<1143:37:40, 854.52s/it]  4%|▎         | 184/5001 [43:12:43<1135:21:26, 848.51s/it]  4%|▎         | 185/5001 [43:26:41<1130:48:59, 845.29s/it]  4%|▎         | 186/5001 [43:40:31<1124:28:31, 840.73s/it]  4%|▎         | 187/5001 [43:54:14<1117:14:27, 835.49s/it]  4%|▍         | 188/5001 [44:07:58<1112:22:30, 832.03s/it]  4%|▍         | 189/5001 [44:21:55<1113:57:58, 833.39s/it]  4%|▍         | 190/5001 [44:35:49<1114:06:13, 833.67s/it]  4%|▍         | 191/5001 [44:49:35<1110:52:46, 831.43s/it]  4%|▍         | 192/5001 [45:03:38<1115:04:52, 834.75s/it]  4%|▍         | 193/5001 [45:17:30<1113:41:38, 833.88s/it]  4%|▍         | 194/5001 [45:31:45<1122:09:53, 840.40s/it]  4%|▍         | 195/5001 [45:45:29<1115:22:27, 835.49s/it]  4%|▍         | 196/5001 [45:59:23<1114:38:58, 835.12s/it]  4%|▍         | 197/5001 [46:13:04<1108:26:41, 830.64s/it]  4%|▍         | 198/5001 [46:27:03<1111:36:45, 833.19s/it]  4%|▍         | 199/5001 [46:41:38<1128:09:46, 845.77s/it]  4%|▍         | 200/5001 [46:55:29<1121:53:23, 841.24s/it]  4%|▍         | 201/5001 [47:09:21<1118:06:17, 838.58s/it]  4%|▍         | 202/5001 [47:23:03<1111:17:40, 833.64s/it]  4%|▍         | 203/5001 [47:36:55<1110:23:18, 833.14s/it]  4%|▍         | 204/5001 [47:50:38<1106:15:21, 830.21s/it]slurmstepd: error: *** JOB 45459640 ON gr026 CANCELLED AT 2024-04-23T19:58:13 DUE TO TIME LIMIT ***
